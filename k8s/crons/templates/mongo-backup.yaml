apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-backup-script
data:
  backup.sh: |
    #!/bin/sh
    # Backup script content here
    #BACKUP_NAME=${BACKUP_VERSION}_$(TZ=${TIMEZONE} date +"%Y%m%d%H%M%S")
    #BACKUP_FILE=${BACKUP_DIR}/${BACKUP_NAME}

    #echo ${BACKUP_FILE}
    echo "Running..."


apiVersion: batch/v1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: "* * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: mongodb-backup
            image: ubuntu
            command: ["/scripts/backup.sh"]
            volumeMounts:
            - name: backup-script
              mountPath: /scripts
          restartPolicy: OnFailure
          volumes:
          - name: backup-script
            configMap:
              name: mongodb-backup-script
              defaultMode: 0500
          restartPolicy: OnFailure
          # containers:
          # - name: mongodb-backup
          #   image: busybox:1.28
          #   env:
          #   - name: TIMEZONE
          #     value: "Asia/Bangkok"
          #   - name: BACKUP_VERSION
          #     value: "v0.0.1"
          #   - name: BACKUP_DIR
          #     value: "/root"